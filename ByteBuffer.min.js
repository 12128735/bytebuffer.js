/*
 ByteBuffer.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/ByteBuffer.js for details
*/
function k(r){throw r;}var m=!0,n=null,p=!1;
(function(r){function s(g){function c(a,b){a="undefined"!=typeof a?parseInt(a,10):c.DEFAULT_CAPACITY;1>a&&(a=c.DEFAULT_CAPACITY);this.array=3==arguments.length&&arguments[2]===m?n:new ArrayBuffer(a);this.view=this.array!=n?new DataView(this.array):n;this.offset=0;this.markedOffset=-1;this.length=0;this.littleEndian="undefined"!=typeof b?!!b:p}c.DEFAULT_CAPACITY=16;c.LITTLE_ENDIAN=m;c.BIG_ENDIAN=p;c.INT8=new Int8Array(1);c.UINT8=new Uint8Array(1);c.INT16=new Int16Array(1);c.UINT16=new Uint16Array(1);
c.INT32=new Int32Array(1);c.UINT32=new Uint32Array(1);c.FLOAT32=new Float32Array(1);c.FLOAT64=new Float64Array(1);c.Long=g;c.cast=function(a,b){a[0]=b;return a[0]};c.allocate=function(a,b){return new c(a,b)};c.wrap=function(a,b){if("string"==typeof a)return(new c).writeUTF8String(a).flip();a.array?a=a.array:a.buffer&&(a=a.buffer);a instanceof ArrayBuffer||k(Error("Cannot wrap buffer of type "+typeof a));var f=new c(0,b,m);f.array=a;f.view=new DataView(f.array);f.offset=0;f.length=a.byteLength;return f};
c.prototype.LE=function(){this.littleEndian=m;return this};c.prototype.BE=function(){this.littleEndian=p;return this};c.prototype.resize=function(a){if(1>a)return p;this.array==n&&(this.array=new ArrayBuffer(a),this.view=new DataView(this.array));if(this.array.byteLength<a){var b=new Uint8Array(this.array);a=new ArrayBuffer(a);(new Uint8Array(a)).set(b);this.array=a;this.view=new DataView(a);return m}return p};c.prototype.slice=function(a,b){this.array==n&&k(Error(this+" cannot be sliced: Already destroyed"));
b<=a&&k(Error(this+" cannot be sliced: End ("+b+") is less than begin ("+a+")"));(0>a||a>this.array.byteLength||1>b||b>this.array.byteLength)&&k(Error(this+" cannot be sliced: Index out of bounds (0-"+this.array.byteLength+" -> "+a+"-"+b+")"));var c=this.clone();c.offset=a;c.length=b;return c};c.prototype.sliceAndCompact=function(a,b){return c.wrap(this.slice(a,b).toArrayBuffer(m))};c.prototype.ensureCapacity=function(a){return this.array==n?this.resize(a):this.array.byteLength<a?this.resize(2*this.array.byteLength>=
a?2*this.array.byteLength:a):p};c.prototype.flip=function(){this.length=this.array==n?0:this.offset;this.offset=0;return this};c.prototype.mark=function(a){this.array==n&&k(Error(this+" cannot be marked: Already destroyed"));a="undefined"!=typeof a?parseInt(a,10):this.offset;(0>a||a>this.array.byteLength)&&k(Error(this+" cannot be marked: Offset to mark is less than 0 or bigger than the capacity ("+this.array.byteLength+"): "+a));this.markedOffset=a;return this};c.prototype.reset=function(){0<=this.markedOffset?
(this.offset=this.markedOffset,this.markedOffset=-1):this.length=this.offset=0;return this};c.prototype.clone=function(){var a=new c(-1,this.littleEndian,m);a.array=this.array;a.view=this.view;a.offset=this.offset;a.length=this.length;return a};c.prototype.copy=function(){if(this.array==n)return this.clone();var a=new c(this.array.byteLength,this.littleEndian),b=new Uint8Array(this.array);(new Uint8Array(a.array)).set(b);a.offset=this.offset;a.length=this.length;return a};c.prototype.remaining=function(){return this.array==
n?0:this.length-this.offset};c.prototype.capacity=function(){return this.array!=n?this.array.byteLength:0};c.prototype.compact=function(){this.array==n&&k(Error(this+" cannot be compacted: Already destroyed"));this.offset>this.length&&this.flip();this.offset==this.length&&k(Error(this+" cannot be compacted: Offset ("+this.offset+") is equal to its length ("+this.length+")"));if(0==this.offset&&this.length==this.array.byteLength)return this;var a=new Uint8Array(this.array),b=new ArrayBuffer(this.length-
this.offset);(new Uint8Array(b)).set(a.subarray(this.offset,this.length));this.array=b;this.offset=0;this.length=this.array.byteLength;return this};c.prototype.destroy=function(){if(this.array!=n)return this.view=this.array=n,this.length=this.offset=0,this};c.prototype.reverse=function(){this.array==n&&k(Error(this+" cannot be reversed: Already destroyed"));Array.prototype.reverse.call(new Uint8Array(this.array));var a=this.offset;this.offset=this.array.byteLength-this.length;this.length=this.array.byteLength-
a;return this};c.prototype.append=function(a,b){a instanceof c||(a=c.wrap(a));a.array==n&&k(Error(a+" cannot be appended to "+this+": Already destroyed"));var f=a.length-a.offset;if(0==f)return this;0>f&&(a=a.clone().flip(),f=a.length-a.offset);b="undefined"!=typeof b?b:(this.offset+=f)-f;this.ensureCapacity(b+f);f=new Uint8Array(a.array);(new Uint8Array(this.array)).set(f.subarray(a.offset,a.length),b);return this};c.prototype.prepend=function(a,b){a instanceof c||(a=c.wrap(a));a.array==n&&k(a+" cannot be prepended to "+
this+": Already destroyed");var f=a.length-a.offset;if(0==f)return this;0>f&&(a=a.clone().flip(),f=a.length-a.offset);var d="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var e=f-b;0<e?(this.ensureCapacity(this.length+e),this.append(this,f),this.offset+=e,this.length+=e,this.append(a,0)):this.append(a,b-f);d&&(this.offset-=f);return this};c.prototype.writeInt8=function(a,b){b="undefined"!=typeof b?b:(this.offset+=1)-1;this.ensureCapacity(b+1);this.view.setInt8(b,a);return this};c.prototype.readInt8=
function(a){a="undefined"!=typeof a?a:(this.offset+=1)-1;a>=this.array.byteLength&&k(Error("Cannot read int8 from "+this+": Capacity overflow"));return this.view.getInt8(a)};c.prototype.writeByte=c.prototype.writeInt8;c.prototype.readByte=c.prototype.readInt8;c.prototype.writeUint8=function(a,b){b="undefined"!=typeof b?b:(this.offset+=1)-1;this.ensureCapacity(b+1);this.view.setUint8(b,a);return this};c.prototype.readUint8=function(a){a="undefined"!=typeof a?a:(this.offset+=1)-1;a>=this.array.byteLength&&
k("Cannot read uint8 from "+this+": Capacity overflow");return this.view.getUint8(a)};c.prototype.writeInt16=function(a,b){b="undefined"!=typeof b?b:(this.offset+=2)-2;this.ensureCapacity(b+2);this.view.setInt16(b,a,this.littleEndian);return this};c.prototype.readInt16=function(a){a="undefined"!=typeof a?a:(this.offset+=2)-2;a+2>this.array.byteLength&&k(Error("Cannot read int16 from "+this+": Capacity overflow"));return this.view.getInt16(a,this.littleEndian)};c.prototype.writeShort=c.prototype.writeInt16;
c.prototype.readShort=c.prototype.readInt16;c.prototype.writeUint16=function(a,b){b="undefined"!=typeof b?b:(this.offset+=2)-2;this.ensureCapacity(b+2);this.view.setUint16(b,a,this.littleEndian);return this};c.prototype.readUint16=function(a){a="undefined"!=typeof a?a:(this.offset+=2)-2;a+2>this.array.b&&k(Error("Cannot read int16 from "+this+": Capacity overflow"));return this.view.getUint16(a,this.littleEndian)};c.prototype.writeInt32=function(a,b){b="undefined"!=typeof b?b:(this.offset+=4)-4;this.ensureCapacity(b+
4);this.view.setInt32(b,a,this.littleEndian);return this};c.prototype.readInt32=function(a){a="undefined"!=typeof a?a:(this.offset+=4)-4;a+4>this.array.byteLength&&k(Error("Cannot read int32 from "+this+": Capacity overflow"));return this.view.getInt32(a,this.littleEndian)};c.prototype.writeInt=c.prototype.writeInt32;c.prototype.readInt=c.prototype.readInt32;c.prototype.writeUint32=function(a,b){b="undefined"!=typeof b?b:(this.offset+=4)-4;this.ensureCapacity(b+4);this.view.setUint32(b,a,this.littleEndian);
return this};c.prototype.readUint32=function(a){a="undefined"!=typeof a?a:(this.offset+=4)-4;a+4>this.array.byteLength&&k(Error("Cannot read uint32 from "+this+": Capacity overflow"));return this.view.getUint32(a,this.littleEndian)};c.prototype.writeFloat32=function(a,b){b="undefined"!=typeof b?b:(this.offset+=4)-4;this.ensureCapacity(b+4);this.view.setFloat32(b,a,this.littleEndian);return this};c.prototype.readFloat32=function(a){a="undefined"!=typeof a?a:(this.offset+=4)-4;(this.array==n||a+4>this.array.byteLength)&&
k(Error("Cannot read float32 from "+this+": Capacity overflow"));return this.view.getFloat32(a,this.littleEndian)};c.prototype.writeFloat=c.prototype.writeFloat32;c.prototype.readFloat=c.prototype.readFloat32;c.prototype.writeFloat64=function(a,b){b="undefined"!=typeof b?b:(this.offset+=8)-8;this.ensureCapacity(b+8);this.view.setFloat64(b,a,this.littleEndian);return this};c.prototype.readFloat64=function(a){a="undefined"!=typeof a?a:(this.offset+=8)-8;(this.array==n||a+8>this.array.byteLength)&&k(Error("Cannot read float64 from "+
this+": Capacity overflow"));return this.view.getFloat64(a,this.littleEndian)};c.prototype.writeDouble=c.prototype.writeFloat64;c.prototype.readDouble=c.prototype.readFloat64;c.prototype.writeInt64=function(a,b){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));b="undefined"!=typeof b?b:(this.offset+=8)-8;"object"==typeof a&&a instanceof g||(a=g.fromNumber(a,p));this.ensureCapacity(b+8);this.littleEndian?(this.view.setInt32(b,
a.getLowBits(),m),this.view.setInt32(b+4,a.getHighBits(),m)):(this.view.setInt32(b,a.getHighBits(),p),this.view.setInt32(b+4,a.getLowBits(),p));return this};c.prototype.readInt64=function(a){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));a="undefined"!=typeof a?a:(this.offset+=8)-8;if(this.array==n||a+8>this.array.byteLength)this.offset-=8,k(Error("Cannot read int64 from "+this+": Capacity overflow"));return this.littleEndian?
g.fromBits(this.view.getInt32(a,m),this.view.getInt32(a+4,m),p):g.fromBits(this.view.getInt32(a+4,p),this.view.getInt32(a,p),p)};c.prototype.writeUint64=function(a,b){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));b="undefined"!=typeof b?b:(this.offset+=8)-8;"object"==typeof a&&a instanceof g||(a=g.fromNumber(a,m));this.ensureCapacity(b+8);this.littleEndian?(this.view.setUint32(b,a.getLowBitsUnsigned(),m),this.view.setUint32(b+
4,a.getHighBitsUnsigned(),m)):(this.view.setUint32(b,a.getHighBitsUnsigned(),p),this.view.setUint32(b+4,a.getLowBitsUnsigned(),p));return this};c.prototype.readUint64=function(a){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));a="undefined"!=typeof a?a:(this.offset+=8)-8;if(this.array==n||a+8>this.array.byteLength)this.offset-=8,k(Error("Cannot read int64 from "+this+": Capacity overflow"));return this.littleEndian?g.fromBits(this.view.getUint32(a,
m),this.view.getUint32(a+4,m),m):g.fromBits(this.view.getUint32(a+4,p),this.view.getUint32(a,p),m)};c.prototype.writeLong=c.prototype.writeInt64;c.prototype.readLong=c.prototype.readInt64;c.MAX_VARINT32_BYTES=5;c.prototype.writeVarint32=function(a,b){var f="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;c.UINT32[0]=a;this.ensureCapacity(b+c.calculateVarint32(a=c.UINT32[0]));var d=new Uint8Array(this.array),e=0;d[b]=a|128;128<=a?(d[b+1]=a>>7|128,16384<=a?(d[b+2]=a>>14|128,2097152<=a?(d[b+
3]=a>>21|128,268435456<=a?(d[b+4]=a>>28&127,e=5):(d[b+3]&=127,e=4)):(d[b+2]&=127,e=3)):(d[b+1]&=127,e=2)):(d[b]&=127,e=1);return f?(this.offset+=e,this):e};c.prototype.readVarint32=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var f=new Uint8Array(this.array),d=0,e;c.UINT32[0]=0;do d==c.MAX_VARINT32_BYTES&&k(Error("Cannot read Varint32 from "+this+"@"+a+": Number of bytes is larger than "+c.MAX_VARINT32_BYTES)),e=f[a+d],c.UINT32[0]|=(e&127)<<7*d,++d;while(e&128);c.INT32[0]=
c.UINT32[0];return b?(this.offset+=d,c.INT32[0]):{value:c.INT32[0],length:d}};c.prototype.writeZigZagVarint32=function(a,b){return this.writeVarint32(c.zigZagEncode32(a),b)};c.prototype.readZigZagVarint32=function(a){a=this.readVarint32(a);return"object"==typeof a?(a.value=c.zigZagDecode32(a.value),a):c.zigZagDecode32(a)};c.MAX_VARINT64_BYTES=10;c.prototype.writeVarint64=function(a,b){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));
var f="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;"object"==typeof a&&a instanceof g||(a=g.fromNumber(a,p));var d=a.toInt()>>>0,e=a.shiftRightUnsigned(28).toInt()>>>0,l=a.shiftRightUnsigned(56).toInt()>>>0,q=c.calculateVarint64(a),h=new Uint8Array(this.array);this.ensureCapacity(b+q);switch(q){case 10:h[b+9]=l>>>7|128;case 9:h[b+8]=l|128;case 8:h[b+7]=e>>>21|128;case 7:h[b+6]=e>>>14|128;case 6:h[b+5]=e>>>7|128;case 5:h[b+4]=e|128;case 4:h[b+3]=d>>>21|128;case 3:h[b+2]=d>>>14|128;case 2:h[b+
1]=d>>>7|128;case 1:h[b+0]=d|128}h[b+q-1]&=127;return f?(this.offset+=q,this):q};c.prototype.readVarint64=function(a){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));var b="undefined"==typeof a,c=a="undefined"!=typeof a?a:this.offset,d=new Uint8Array(this.array),e,l=0,q=0,h;h=d[a++];e=h&127;h&128&&(h=d[a++],e|=(h&127)<<7,h&128&&(h=d[a++],e|=(h&127)<<14,h&128&&(h=d[a++],e|=(h&127)<<21,h&128&&(h=d[a++],l=h&127,h&128&&(h=d[a++],
l|=(h&127)<<7,h&128&&(h=d[a++],l|=(h&127)<<14,h&128&&(h=d[a++],l|=(h&127)<<21,h&128&&(h=d[a++],q=h&127,h&128&&(h=d[a++],q|=(h&127)<<7,h&128&&k(Error("Data must be corrupt: Buffer overrun")))))))))));d=g.from28Bits(e,l,q,p);return b?(this.offset=a,d):{value:d,length:a-c}};c.prototype.writeZigZagVarint64=function(a,b){return this.writeVarint64(c.zigZagEncode64(a),b)};c.prototype.readZigZagVarint64=function(a){a=this.readVarint64(a);return"object"==typeof a&&!(a instanceof g)?(a.value=c.zigZagDecode64(a.value),
a):c.zigZagDecode64(a)};c.prototype.writeVarint=c.prototype.writeVarint32;c.prototype.readVarint=c.prototype.readVarint32;c.prototype.writeZigZagVarint=c.prototype.writeZigZagVarint32;c.prototype.readZigZagVarint=c.prototype.readZigZagVarint32;c.calculateVarint32=function(a){a>>>=0;return 128>a?1:16384>a?2:2097152>a?3:268435456>a?4:5};c.calculateVarint64=function(a){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));"object"==
typeof a&&a instanceof g||(a=g.fromNumber(a,p));var b=a.toInt()>>>0,c=a.shiftRightUnsigned(28).toInt()>>>0;a=a.shiftRightUnsigned(56).toInt()>>>0;return 0==a?0==c?16384>b?128>b?1:2:2097152>b?3:4:16384>c?128>c?5:6:2097152>c?7:8:128>a?9:10};c.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0};c.zigZagDecode32=function(a){return a>>>1^-(a&1)|0};c.zigZagEncode64=function(a){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));
"object"==typeof a&&a instanceof g?a.unsigned&&(a=a.toSigned()):a=g.fromNumber(a,p);return a.shiftLeft(1).xor(a.shiftRight(63)).toUnsigned()};c.zigZagDecode64=function(a){g||k(Error("Long support is not available: See https://github.com/dcodeIO/ByteBuffer.js#on-long-int64-support for details"));"object"==typeof a&&a instanceof g?a.unsigned||(a=a.toUnsigned()):a=g.fromNumber(a,m);return a.shiftRightUnsigned(1).xor(a.and(g.ONE).toSigned().negate()).toSigned()};c.decodeUTF8Char=function(a,b){var c=a.readUint8(b),
d,e,l,q,h,g=b;0==(c&128)?(d=c,b+=1):192==(c&224)?(d=a.readUint8(b+1),d=(c&31)<<6|d&63,b+=2):224==(c&240)?(d=a.readUint8(b+1),e=a.readUint8(b+2),d=(c&15)<<12|(d&63)<<6|e&63,b+=3):240==(c&248)?(d=a.readUint8(b+1),e=a.readUint8(b+2),l=a.readUint8(b+3),d=(c&7)<<18|(d&63)<<12|(e&63)<<6|l&63,b+=4):248==(c&252)?(d=a.readUint8(b+1),e=a.readUint8(b+2),l=a.readUint8(b+3),q=a.readUint8(b+4),d=(c&3)<<24|(d&63)<<18|(e&63)<<12|(l&63)<<6|q&63,b+=5):252==(c&254)?(d=a.readUint8(b+1),e=a.readUint8(b+2),l=a.readUint8(b+
3),q=a.readUint8(b+4),h=a.readUint8(b+5),d=(c&1)<<30|(d&63)<<24|(e&63)<<18|(l&63)<<12|(q&63)<<6|h&63,b+=6):k(Error("Cannot decode UTF8 character at offset "+b+": charCode (0x"+c.toString(16)+") is invalid"));return{"char":d,length:b-g}};c.encodeUTF8Char=function(a,b,c){var d=c;0>a&&k(Error("Cannot encode UTF8 character: charCode ("+a+") is negative"));128>a?(b.writeUint8(a&127,c),c+=1):2048>a?(b.writeUint8(a>>6&31|192,c).writeUint8(a&63|128,c+1),c+=2):65536>a?(b.writeUint8(a>>12&15|224,c).writeUint8(a>>
6&63|128,c+1).writeUint8(a&63|128,c+2),c+=3):2097152>a?(b.writeUint8(a>>18&7|240,c).writeUint8(a>>12&63|128,c+1).writeUint8(a>>6&63|128,c+2).writeUint8(a&63|128,c+3),c+=4):67108864>a?(b.writeUint8(a>>24&3|248,c).writeUint8(a>>18&63|128,c+1).writeUint8(a>>12&63|128,c+2).writeUint8(a>>6&63|128,c+3).writeUint8(a&63|128,c+4),c+=5):2147483648>a?(b.writeUint8(a>>30&1|252,c).writeUint8(a>>24&63|128,c+1).writeUint8(a>>18&63|128,c+2).writeUint8(a>>12&63|128,c+3).writeUint8(a>>6&63|128,c+4).writeUint8(a&63|
128,c+5),c+=6):k(Error("Cannot encode UTF8 character: charCode (0x"+a.toString(16)+") is too large (>= 0x80000000)"));return c-d};c.calculateUTF8Char=function(a){0>a&&k(Error("Cannot calculate length of UTF8 character: charCode ("+a+") is negative"));if(128>a)return 1;if(2048>a)return 2;if(65536>a)return 3;if(2097152>a)return 4;if(67108864>a)return 5;if(2147483648>a)return 6;k(Error("Cannot calculate length of UTF8 character: charCode (0x"+a.toString(16)+") is too large (>= 0x80000000)"))};c.a=function(a){a=
""+a;for(var b=0,f=0;f<a.length;f++)b+=c.calculateUTF8Char(a.charCodeAt(f));return b};c.prototype.writeUTF8String=function(a,b){var f="undefined"==typeof b,d=b="undefined"!=typeof b?b:this.offset,e=c.a(a);this.ensureCapacity(b+e);for(e=0;e<a.length;e++)b+=c.encodeUTF8Char(a.charCodeAt(e),this,b);return f?(this.offset=b,this):b-d};c.prototype.readUTF8String=function(a,b){var f="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;for(var d,e="",l=b,g=0;g<a;g++)d=c.decodeUTF8Char(this,b),b+=d.length,
e+=String.fromCharCode(d["char"]);return f?(this.offset=b,e):{string:e,length:b-l}};c.prototype.readUTF8StringBytes=function(a,b){var f="undefined"==typeof b;b="undefined"!=typeof b?b:this.offset;var d,e="",l=b;for(a=b+a;b<a;)d=c.decodeUTF8Char(this,b),b+=d.length,e+=String.fromCharCode(d["char"]);b!=a&&k(Error("Actual string length differs from the specified: "+((b>a?"+":"")+b-a)+" bytes"));return f?(this.offset=b,e):{string:e,length:b-l}};c.prototype.writeLString=function(a,b){a=""+a;var f="undefined"==
typeof b;b="undefined"!=typeof b?b:this.offset;var d=c.encodeUTF8Char(a.length,this,b),d=d+this.writeUTF8String(a,b+d);return f?(this.offset+=d,this):d};c.prototype.readLString=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var f=c.decodeUTF8Char(this,a);a=this.readUTF8String(f["char"],a+f.length);return b?(this.offset+=f.length+a.length,a.string):{string:a.string,length:f.length+a.length}};c.prototype.writeVString=function(a,b){a=""+a;var f="undefined"==typeof b;b=
"undefined"!=typeof b?b:this.offset;var d=this.writeVarint32(c.a(a),b),d=d+this.writeUTF8String(a,b+d);return f?(this.offset+=d,this):d};c.prototype.readVString=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var c=this.readVarint32(a);a=this.readUTF8StringBytes(c.value,a+c.length);return b?(this.offset+=c.length+a.length,a.string):{string:a.string,length:c.length+a.length}};c.prototype.writeCString=function(a,b){var c="undefined"==typeof b;b="undefined"!=typeof b?b:
this.offset;var d=this.writeUTF8String(""+a,b);this.writeUint8(0,b+d);return c?(this.offset+=d+1,this):d+1};c.prototype.readCString=function(a){var b="undefined"==typeof a;a="undefined"!=typeof a?a:this.offset;var f,d="",e=a;do f=c.decodeUTF8Char(this,a),a+=f.length,0!=f["char"]&&(d+=String.fromCharCode(f["char"]));while(0!=f["char"]);return b?(this.offset=a,d):{string:d,length:a-e}};c.prototype.writeJSON=function(a,b,c){c="function"==typeof c?c:JSON.stringify;return this.writeLString(c(a),b)};c.prototype.readJSON=
function(a,b){b="function"==typeof b?b:JSON.parse;var c=this.readLString(a);return"string"==typeof c?b(c):{data:b(c.string),length:c.length}};c.prototype.printDebug=function(a){for(var b=(this.array!=n?"ByteBuffer(offset="+this.offset+",markedOffset="+this.markedOffset+",length="+this.length+",capacity="+this.array.byteLength+")":"ByteBuffer(DESTROYED)")+"\n-------------------------------------------------------------------\n",c=this.toHex(16,m),d=this.toASCII(16,m),e=0;e<c.length;e++)b+=c[e]+"  "+
d[e]+"\n";if(a===m)return b;"function"==typeof a?a(b):console.log(b)};c.prototype.toHex=function(a,b){if(this.array==n)return"DESTROYED";b=!!b;a="undefined"!=typeof a?parseInt(a,10):16;1>a&&(a=16);for(var c="",d=[],e=new Uint8Array(this.array),c=0==this.offset&&0==this.length?c+"|":0==this.length?c+">":0==this.offset?c+"<":c+" ",l=0;l<this.array.byteLength;l++){0<l&&0==l%a&&(d.push(c),c=" ");var g=e[l],g=g.toString(16).toUpperCase();2>g.length&&(g="0"+g);c+=g;c=l+1==this.offset&&l+1==this.length?
c+"|":l+1==this.offset?c+"<":l+1==this.length?c+">":c+" "}if(b)for(;c.length<3*a+1;)c+="   ";d.push(c);return b?d:d.join("\n")};c.prototype.toASCII=function(a,b){if(this.array==n)return"";b=!!b;a="undefined"!=typeof a?parseInt(a,10):16;1>a&&(a=16);for(var c="",d=[],e=new Uint8Array(this.array),g=0;g<this.array.byteLength;g++){0<g&&0==g%a&&(d.push(c),c="");var q=e[g],q=32<q&&127>q?String.fromCharCode(q):".",c=c+q}d.push(c);return b?d:d.join("\n")+"\n"};c.prototype.toString=function(){return this.array==
n?"ByteBuffer(DESTROYED)":"ByteBuffer(offset="+this.offset+",markedOffset="+this.markedOffset+",length="+this.length+",capacity="+this.array.byteLength+")"};c.prototype.toArrayBuffer=function(a){var b=this.clone();b.offset>b.length&&b.flip();var c=p;if(0<b.offset||b.length<b.array.byteLength)b.compact(),c=m;return a&&!c?b.copy().array:b.array};c.extend=function(a,b){"string"==typeof a&&"function"==typeof b?c.prototype[a]=b:k(Error("Cannot extend prototype with "+a+"="+b+" (exptected string and function)"))};
return c}"undefined"!=typeof module&&module.exports?module.exports=s(require("long")):"undefined"!=typeof define&&define.amd?define("ByteBuffer",["Math/Long"],function(g){return s(g)}):(r.dcodeIO||(r.dcodeIO={}),r.dcodeIO.ByteBuffer=s(dcodeIO.Long))})(this);
